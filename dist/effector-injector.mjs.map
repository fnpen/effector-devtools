{
  "version": 3,
  "sources": ["../node_modules/lodash.debounce/index.js", "../src/injector/index.ts", "../src/common/constants.ts", "../src/common/filterLogsFn.ts", "../node_modules/rempl/src/utils/global.ts", "../node_modules/rempl/src/classes/ReactiveValue.ts", "../node_modules/rempl/src/classes/EndpointList.ts", "../node_modules/rempl/src/classes/EndpointListSet.ts", "../node_modules/rempl/src/utils/index.ts", "../node_modules/rempl/src/transport/event.ts", "../node_modules/rempl/src/classes/Namespace.ts", "../node_modules/rempl/src/classes/Endpoint.ts", "../node_modules/rempl/src/classes/Publisher.ts", "../node_modules/rempl/src/sandbox/browser/sandbox-init.ts", "../node_modules/rempl/src/sandbox/browser/index.ts", "../node_modules/rempl/src/host/in-page/createElement.ts", "../node_modules/rempl/lib/host/in-page/style.js", "../node_modules/rempl/src/host/in-page/view.ts", "../node_modules/rempl/src/host/in-page/index.ts", "../node_modules/rempl/src/publisher/TransportPublisher.ts", "../node_modules/rempl/src/publisher/factory.ts", "../node_modules/rempl/src/transport/ws.ts", "../node_modules/rempl/lib/publisher/browser/identify/style.js", "../node_modules/rempl/src/publisher/browser/identify/index.ts", "../node_modules/rempl/src/publisher/browser/transport-ws.ts", "../node_modules/rempl/src/publisher/browser/index.ts", "../src/injector/config.ts", "../src/injector/rempl-publisher.ts"],
  "sourcesContent": ["/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = debounce;\n", "import { State } from \"common-types\";\nimport {\n  createEffect as createEffectOrig,\n  createEvent as createEventOrig,\n  createStore as createStoreOrig,\n  Effect,\n  Event,\n  Store,\n  Subscription,\n  Unit,\n} from \"effector\";\nimport debounce from \"lodash.debounce\";\nimport { defaultState } from \"../common/constants\";\n\nimport { filterLogsFn } from \"../common/filterLogsFn\";\nimport { setConfig } from \"./config\";\n\nimport type { Publisher } from \"./rempl-publisher\";\nimport { publisher, publishLog } from \"./rempl-publisher\";\n\nconst localData = ((): Partial<State> => {\n  let data = {} as State;\n  try {\n    data = JSON.parse(window.localStorage.getItem(\"effector-devtools\") || \"{}\");\n  } catch (e) {\n    console.log(\"localData parsing issue.\");\n  }\n  return data;\n})();\n\ntype Loggable = {\n  enabled: boolean;\n  unwatch?: Subscription;\n  setEnabled: (enabled: boolean) => void;\n  getKind: () => string;\n  getName: () => string;\n  log: (op: string, payload?: any) => void;\n  // graphite: Node;\n};\n\nclass Controller {\n  publisher: Publisher;\n\n  state: State;\n\n  _events: Set<{ logger: Loggable }> = new Set();\n\n  constructor(publisher: Publisher) {\n    this.state = {\n      ...defaultState,\n      ...localData,\n    };\n\n    console.log(\"initial\", this.state);\n\n    this.publisher = publisher;\n\n    this.bindRemote();\n\n    this.sendState();\n  }\n\n  getState() {\n    return {\n      ...this.state,\n      subscriptions: Array.from(this._events.values())\n        .filter(unit => unit.logger.enabled)\n        .map(unit => unit.logger.getName()),\n    };\n  }\n\n  sendState = debounce(() => {\n    this.publisher.ns(\"state\").publish(this.getState());\n    window.localStorage.setItem(\n      \"effector-devtools\",\n      JSON.stringify(this.state)\n    );\n  }, 80);\n\n  bindRemote() {\n    this.publisher.provide(\"setZoom\", this.setZoom.bind(this));\n    this.publisher.provide(\"setEnabled\", this.setEnabled.bind(this));\n    this.publisher.provide(\"setFilterQuery\", this.setFilterQuery.bind(this));\n  }\n\n  setFilterQuery(query: string) {\n    if (this.state.query === query) {\n      return;\n    }\n\n    this.state.query = query;\n\n    this.setEnabled(this.state.enabled);\n\n    this.sendState();\n  }\n\n  setZoom(zoom: number) {\n    this.state.zoom = zoom;\n    this.sendState();\n  }\n\n  setEnabled(enabled: boolean) {\n    this.state.enabled = enabled;\n\n    const filterFn = filterLogsFn(this.state.query);\n\n    for (let unit of this._events) {\n      if (!enabled) {\n        unit.logger.setEnabled(false);\n        continue;\n      }\n\n      unit.logger.setEnabled(filterFn(unit.logger.getName()));\n    }\n  }\n\n  onUnitCreate(unit: { logger: Loggable }) {\n    this._events.add(unit);\n\n    if (this.state.enabled) {\n      unit.logger.setEnabled(true);\n    }\n\n    unit.logger.log(\"unit-create\");\n\n    this.sendState();\n  }\n\n  createLogger<T>(unit: Unit<T>, parent?: Unit<T>) {\n    const logger: Loggable = {\n      enabled: false,\n      getName: () => {\n        return (\n          (parent ? (parent as any).shortName + \".\" : \"\") +\n          (unit as any).shortName\n        );\n      },\n      getKind: () => (parent ? parent : unit).kind,\n      setEnabled: enabled => {\n        if (enabled === logger.enabled) {\n          return;\n        }\n\n        if (enabled) {\n          if (!logger.enabled) {\n            const unwatch = unit.watch(payload => {\n              unit.logger.log(\"unit-watch\", payload);\n            });\n\n            logger.unwatch = unwatch;\n          }\n        } else if (logger.unwatch) {\n          logger.unwatch();\n        }\n\n        logger.enabled = enabled;\n\n        this.sendState();\n      },\n      log: (op: string, payload?: any) => {\n        publishLog({\n          op,\n          kind: logger.getKind(),\n          name: logger.getName(),\n          payload,\n        });\n      },\n    };\n\n    return logger;\n  }\n}\n\nconst controller = new Controller(publisher);\n\nconst attachLogger = <T>(unit: Unit<T>, parent?: Unit<T>) => {\n  (unit as any).logger = controller.createLogger(unit, parent);\n\n  controller.onUnitCreate(unit as any);\n};\n\nconst createStore: typeof createStoreOrig = <T>(...args: any) => {\n  const event = createStoreOrig(...args) as Loggable & Store<T>;\n\n  attachLogger(event);\n\n  return event;\n};\n\nconst createEvent: typeof createEventOrig = <T>(...args: any) => {\n  const event = createEventOrig(...args) as Loggable & Event<T>;\n\n  attachLogger(event);\n\n  return event;\n};\n\nconst createEffect: typeof createEffectOrig = <T, A>(...args: any) => {\n  const effect = createEffectOrig(...args) as Loggable & Effect<T, A>;\n\n  attachLogger(effect);\n  attachLogger(effect.done, effect);\n  attachLogger(effect.fail, effect);\n  attachLogger(effect.finally, effect);\n\n  return effect;\n};\n\nexport * from \"effector\";\nexport { createEvent, createEffect, createStore, setConfig as config };\n", "import { StaticState } from \"common-types\";\n\nexport const ToolId = \"\u2604\uFE0F Effector\";\n\n// export const UnitTypeEvent: UnitType = 1;\n\n// export const unitTypeName: Record<UnitType, string> = {\n//   [UnitTypeEvent]: \"Event\",\n// };\n\nexport const defaultState: StaticState = {\n  enabled: false,\n  expanded: false,\n  zoom: 1.0,\n  query: \"\",\n};\n", "export const filterLogsFn = query => {\n  if (!query) {\n    return () => true;\n  }\n\n  const rw = new RegExp(query.replace(/[/\\-\\\\^$*+?.()[\\]{}]/g, \"\\\\$&\"), \"i\");\n\n  return name => {\n    return rw.test(name);\n  };\n};\n", "/* eslint-disable no-restricted-globals */\n// adopted from core-js\n// https://github.com/zloirock/core-js/blob/71adeb4a264f77df25931582493a290b94cd9c48/packages/core-js/internals/global.js\n\nfunction check(it: any) {\n    return it && it.Math === Math && it;\n}\n\nconst resolvedGlobalThis =\n    check(typeof globalThis === 'object' && globalThis) ||\n    check(typeof window === 'object' && window) ||\n    check(typeof self === 'object' && self) ||\n    check(typeof global === 'object' && global) ||\n    (function () {\n        // @ts-ignore\n        return this;\n    })() ||\n    Function('return this')();\n\nconst resolvedTop = resolvedGlobalThis.top || resolvedGlobalThis;\nconst resolvedParent = resolvedGlobalThis.parent || resolvedGlobalThis;\nconst resolvedOpener = resolvedGlobalThis.opener || null;\n\nexport {\n    resolvedGlobalThis as globalThis,\n    resolvedTop as top,\n    resolvedParent as parent,\n    resolvedOpener as opener,\n};\n", "export type OnChangeCallback<TContext, T> = (this: TContext, value: T) => void;\nexport type Handler<T> = {\n    fn(value: T): void;\n    context: unknown;\n    handler: Handler<T> | null;\n};\n\nexport class ReactiveValue<T> {\n    value: T;\n    handler: Handler<T> | null = null;\n\n    constructor(value: T) {\n        this.value = value;\n    }\n\n    /**\n     * Set new value and call apply method if value has been changed.\n     */\n    set(value: T): void {\n        if (!Object.is(this.value, value)) {\n            this.value = value;\n            this.apply();\n        }\n    }\n\n    /**\n     * Returns current token value.\n     */\n    get(): T {\n        return this.value;\n    }\n\n    /**\n     * Adds a callback on token value changes.\n     */\n    on<TContext>(fn: OnChangeCallback<TContext, T>, context?: TContext): void {\n        let cursor = this.handler;\n\n        while (cursor !== null) {\n            if (cursor.fn === fn && cursor.context === context) {\n                console.warn('ReactiveValue#on: duplicate fn & context pair');\n            }\n\n            cursor = cursor.handler;\n        }\n\n        this.handler = {\n            fn,\n            context,\n            handler: this.handler,\n        };\n    }\n\n    /**\n     * Adds a callback on token value changes and invokes callback with current value.\n     */\n    link<TContext>(fn: OnChangeCallback<TContext, T>, context?: TContext): void {\n        this.on(fn, context);\n        fn.call(context as TContext, this.value);\n    }\n\n    /**\n     * Removes a callback. Must be passed the same arguments as for ReactiveValue#on() method.\n     */\n    off<TContext>(fn: OnChangeCallback<TContext, T>, context?: TContext): void {\n        // todo rework\n        let cursor = this.handler;\n        let prev: Handler<T> | this = this;\n\n        while (cursor !== null) {\n            if (cursor.fn === fn && cursor.context === context) {\n                // make it non-callable\n                cursor.fn = function () {};\n\n                // remove from list\n                prev.handler = cursor.handler;\n\n                return;\n            }\n\n            prev = cursor;\n            cursor = cursor.handler;\n        }\n\n        console.warn('ReactiveValue#off: fn & context pair not found, nothing was removed');\n    }\n\n    /**\n     * Call all callbacks with current token value.\n     */\n    apply(): void {\n        // todo rework\n        let cursor = this.handler;\n\n        while (cursor !== null) {\n            cursor.fn.call(cursor.context, this.value);\n            cursor = cursor.handler;\n        }\n    }\n}\n", "import { ReactiveValue } from './ReactiveValue.js';\n\nfunction normalize(oldList: string[], newList?: string[]) {\n    const uniqueItems = [...new Set(Array.isArray(newList) ? newList : [])];\n    const diff =\n        uniqueItems.length !== oldList.length ||\n        uniqueItems.some((endpoint) => !oldList.includes(endpoint));\n\n    return diff ? uniqueItems : oldList;\n}\n\nexport class EndpointList extends ReactiveValue<string[]> {\n    constructor(list?: string[]) {\n        super(normalize([], list));\n    }\n\n    set(newValue: string[]): void {\n        super.set(normalize(this.value, newValue));\n    }\n}\n", "import { EndpointList } from './EndpointList.js';\n\nexport class EndpointListSet extends EndpointList {\n    endpointLists = new Set<EndpointList>();\n\n    constructor() {\n        super([]);\n    }\n\n    set() {\n        super.set(\n            ([] as string[]).concat(\n                ...[...this.endpointLists].map((endpointList) => endpointList.value)\n            )\n        );\n    }\n\n    add(endpointList: EndpointList) {\n        if (!this.endpointLists.has(endpointList)) {\n            this.endpointLists.add(endpointList);\n            endpointList.on(this.set, this);\n            this.set();\n        }\n    }\n\n    remove(endpointList: EndpointList) {\n        if (this.endpointLists.has(endpointList)) {\n            this.endpointLists.delete(endpointList);\n            endpointList.off(this.set, this);\n            this.set();\n        }\n    }\n}\n", "import { globalThis } from './global.js';\nexport * from './global.js';\n\nexport const trustedEmptyHTML = globalThis.trustedTypes?.emptyHTML;\n\nexport type Fn<TArgs extends unknown[], TReturn, TThis = unknown> = (\n    this: TThis,\n    ...args: TArgs\n) => TReturn;\n\nexport type AnyFn = Fn<any[], any>;\n\nexport function genUID(len?: number): string {\n    function base36(val: number) {\n        return Math.round(val).toString(36);\n    }\n\n    // uid should starts with alpha\n    let result = base36(10 + 25 * Math.random());\n\n    if (!len) {\n        len = 16;\n    }\n\n    while (result.length < len) {\n        result += base36(Date.now() * Math.random());\n    }\n\n    return result.substr(0, len);\n}\n\nexport type UnsubscribeFn = () => void;\n\nexport function subscribe<TItem>(list: TItem[], item: TItem): UnsubscribeFn {\n    list.push(item);\n\n    return () => {\n        const idx = list.indexOf(item);\n\n        if (idx !== -1) {\n            list.splice(idx, 1);\n        }\n    };\n}\n", "/* eslint-env browser */\n\nimport { ReactiveValue } from '../classes/ReactiveValue.js';\nimport { EndpointList } from '../classes/EndpointList.js';\nimport { EndpointListSet } from '../classes/EndpointListSet.js';\nimport * as utils from '../utils/index.js';\nimport { globalThis, AnyFn, UnsubscribeFn } from '../utils/index.js';\nimport {\n    GetRemoteUIInternalHandler,\n    EventTransportHandshakePayload,\n    EventTransportMessagePayload,\n    EventTransportConnectTo,\n    EventTransportEndpoint,\n    EventTransportChannelId,\n} from '../types.js';\nimport { EventTransportMessage } from '../types.js';\nimport { Publisher } from '../classes/Publisher.js';\nimport { Subscriber } from '../classes/Subscriber.js';\n\nconst DEBUG = false;\nconst DEBUG_PREFIX = '[rempl][event-transport] ';\n\nexport type TransportEndpoint = (Publisher | Subscriber | { id?: string }) & {\n    getRemoteUI?: GetRemoteUIInternalHandler;\n};\n\nexport type OnInitCallbackArg = {\n    connected: ReactiveValue<boolean>;\n    subscribe(fn: AnyFn): UnsubscribeFn;\n    getRemoteUI(callback?: AnyFn): void;\n    send(...args: unknown[]): void;\n};\n\nexport type OnInitCallback = (arg: OnInitCallbackArg) => void;\nexport type OnInitFnArgs = [endpoint: TransportEndpoint, callback: OnInitCallback];\n\nexport type Connection = {\n    ttl: number;\n    endpoints: EndpointList;\n};\n\nexport type CallbackPayload<TArgs extends unknown[]> = {\n    type: 'callback';\n    callback(...args: TArgs): void;\n    data: TArgs;\n};\n\nconst allTransports: EventTransport[] = [];\n\nexport class EventTransport {\n    static get(\n        name: EventTransportEndpoint,\n        connectTo: EventTransportEndpoint,\n        win?: Window | typeof globalThis\n    ): EventTransport {\n        if (!win) {\n            win = globalThis;\n        }\n\n        const transport = allTransports.find(\n            (transport) =>\n                transport.name === name &&\n                transport.connectTo === connectTo &&\n                transport.realm === win\n        );\n\n        return transport || new EventTransport(name, connectTo, win);\n    }\n\n    name: EventTransportEndpoint;\n    connectTo: EventTransportEndpoint;\n    realm: Window | typeof globalThis;\n    inputChannelId: EventTransportChannelId;\n    connections = new Map<EventTransportChannelId, Connection>();\n    connected = new ReactiveValue(false);\n    endpointGetUI = new Map<string, GetRemoteUIInternalHandler>();\n    ownEndpoints = new EndpointList();\n    remoteEndpoints = new EndpointListSet();\n\n    initCallbacks: OnInitFnArgs[] = [];\n    dataCallbacks: Array<{ endpoint: string; fn: AnyFn }> = [];\n    sendCallbacks = new Map<string, AnyFn>();\n    inited = false;\n\n    constructor(\n        name: EventTransportEndpoint,\n        connectTo: EventTransportEndpoint,\n        win?: Window | typeof globalThis\n    ) {\n        if (allTransports.length === 0 && typeof addEventListener === 'function') {\n            addEventListener(\n                'message',\n                (e: MessageEvent) => {\n                    for (const transport of allTransports) {\n                        transport._onMessage(e);\n                    }\n                },\n                false\n            );\n        }\n\n        allTransports.push(this);\n\n        this.name = name;\n        this.connectTo = connectTo;\n        this.inputChannelId = `${name}/${utils.genUID()}`;\n        this.realm = win || globalThis;\n\n        this.ownEndpoints.on((endpoints) => {\n            if (this.connected.value) {\n                this.send({\n                    type: 'endpoints',\n                    data: [endpoints],\n                });\n            }\n        });\n\n        if (\n            typeof this.realm.postMessage !== 'function' ||\n            typeof addEventListener !== 'function'\n        ) {\n            console.warn(DEBUG_PREFIX + \"Event (postMessage) transport isn't supported\");\n            return;\n        }\n\n        this._handshake(false);\n    }\n\n    _handshake(inited: boolean) {\n        this._send(`${this.connectTo}:connect`, {\n            type: 'handshake',\n            initiator: this.name,\n            inited,\n            endpoints: this.ownEndpoints.value,\n        });\n    }\n\n    _onMessage(event: MessageEvent<EventTransportMessage>) {\n        if (event.source !== this.realm || event.target !== globalThis) {\n            return;\n        }\n\n        const data = event.data || {};\n        const connectTo: EventTransportConnectTo = `${this.name}:connect`;\n\n        switch (data.to) {\n            case connectTo:\n                if (data.payload?.initiator === this.connectTo) {\n                    this._onConnect(data.from, data.payload);\n                }\n                break;\n\n            case this.inputChannelId:\n                if (this.connections.has(data.from)) {\n                    this._onData(data.from, data.payload);\n                } else {\n                    console.warn(DEBUG_PREFIX + 'unknown incoming connection', data.from);\n                }\n                break;\n        }\n    }\n\n    _onConnect(from: EventTransportChannelId, payload: EventTransportHandshakePayload) {\n        if (!payload.inited) {\n            this._handshake(true);\n        }\n\n        if (!this.connections.has(from)) {\n            const endpoints = new EndpointList(payload.endpoints);\n\n            this.remoteEndpoints.add(endpoints);\n            this.connections.set(from, {\n                ttl: Date.now(),\n                endpoints,\n            });\n            this._send(from, {\n                type: 'connect',\n                endpoints: this.ownEndpoints.value,\n            });\n        }\n\n        this.inited = true;\n    }\n\n    _onData(from: EventTransportChannelId, payload: EventTransportMessagePayload) {\n        if (DEBUG) {\n            console.log(DEBUG_PREFIX + 'receive from ' + this.connectTo, payload.type, payload);\n        }\n\n        switch (payload.type) {\n            case 'connect': {\n                this.connections.get(from)?.endpoints.set(payload.endpoints);\n                this.connected.set(true);\n                this.initCallbacks.splice(0).forEach((args) => this.onInit(...args));\n                break;\n            }\n\n            case 'endpoints': {\n                this.connections.get(from)?.endpoints.set(payload.data[0]);\n                break;\n            }\n\n            case 'disconnect': {\n                this.connections.get(from)?.endpoints.set([]);\n                this.connected.set(false);\n                break;\n            }\n\n            case 'callback': {\n                if (payload.callback) {\n                    const callback = this.sendCallbacks.get(payload.callback);\n\n                    if (typeof callback === 'function') {\n                        callback(...payload.data);\n                        this.sendCallbacks.delete(payload.callback);\n                    }\n                }\n                break;\n            }\n\n            case 'data': {\n                let args = payload.data;\n                const callback = payload.callback;\n\n                if (callback) {\n                    args = args.concat(this._wrapCallback(from, callback));\n                }\n\n                for (const { endpoint, fn } of this.dataCallbacks) {\n                    if (endpoint === payload.endpoint) {\n                        fn(...args);\n                    }\n                }\n                break;\n            }\n            case 'getRemoteUI': {\n                if (!payload.endpoint) {\n                    return;\n                }\n\n                const getUI = this.endpointGetUI.get(payload.endpoint);\n\n                if (typeof getUI !== 'function') {\n                    console.warn(\n                        DEBUG_PREFIX +\n                            'receive unknown endpoint for getRemoteUI(): ' +\n                            payload.endpoint\n                    );\n\n                    if (payload.callback) {\n                        this._wrapCallback(\n                            from,\n                            payload.callback\n                        )('Wrong endpoint \u2013 ' + payload.endpoint);\n                    }\n                } else {\n                    if (payload.callback) {\n                        const callback = this._wrapCallback(from, payload.callback);\n\n                        getUI(payload.data[0] || {})\n                            .catch((error) => ({ error: String(error?.message) }))\n                            .then((res) => {\n                                if ('error' in res) {\n                                    callback(res.error);\n                                } else {\n                                    callback(null, res.type, res.value);\n                                }\n                            });\n                    }\n                }\n                break;\n            }\n\n            default:\n                console.warn(\n                    DEBUG_PREFIX +\n                        'Unknown message type `' +\n                        // @ts-ignore\n                        payload.type +\n                        '` for `' +\n                        this.name +\n                        '`',\n                    payload\n                );\n        }\n    }\n\n    _wrapCallback(to: EventTransportChannelId, callback: string) {\n        return (...args: unknown[]) =>\n            this._send(to, {\n                type: 'callback',\n                callback,\n                data: args,\n            });\n    }\n\n    _send(to: EventTransportConnectTo, payload: EventTransportHandshakePayload): void;\n    _send(to: EventTransportChannelId, payload: EventTransportMessagePayload): void;\n    _send(to: EventTransportConnectTo | EventTransportChannelId, payload: any): void {\n        if (DEBUG) {\n            console.log(DEBUG_PREFIX + 'emit event', to, payload);\n        }\n\n        if (typeof this.realm.postMessage === 'function') {\n            const message: EventTransportMessage = {\n                from: this.inputChannelId,\n                to,\n                payload,\n            };\n\n            this.realm.postMessage(message, '*');\n        }\n    }\n\n    subscribeToEndpoint(endpoint: string | null, fn: AnyFn) {\n        return utils.subscribe(this.dataCallbacks, {\n            endpoint,\n            fn,\n        });\n    }\n\n    sendToEndpoint<\n        M extends Extract<EventTransportMessagePayload, { endpoint: string | null }>,\n        K extends M['type']\n    >(endpoint: string | null, type: K, ...args: any) {\n        let callback: string | null = null;\n\n        if (args.length && typeof args[args.length - 1] === 'function') {\n            callback = utils.genUID();\n            this.sendCallbacks.set(callback, args.pop() as AnyFn);\n        }\n\n        this.send({\n            type,\n            endpoint,\n            data: args,\n            callback,\n        });\n    }\n\n    send(payload: EventTransportMessagePayload) {\n        for (const channelId of this.connections.keys()) {\n            this._send(channelId, payload);\n        }\n    }\n\n    onInit(endpoint: TransportEndpoint, callback: OnInitCallback) {\n        const id = endpoint.id || null;\n\n        if (id) {\n            this.ownEndpoints.set(this.ownEndpoints.value.concat(id));\n\n            if (typeof endpoint.getRemoteUI === 'function') {\n                this.endpointGetUI.set(id, endpoint.getRemoteUI);\n            }\n        }\n\n        if (this.inited) {\n            callback({\n                connected: this.connected,\n                subscribe: this.subscribeToEndpoint.bind(this, id),\n                getRemoteUI: this.sendToEndpoint.bind(this, id, 'getRemoteUI'),\n                send: this.sendToEndpoint.bind(this, id, 'data'),\n            });\n        } else {\n            this.initCallbacks.push([endpoint, callback]);\n        }\n\n        return this;\n    }\n\n    sync(endpoint: Publisher | Subscriber) {\n        const channel = utils.genUID(8) + ':' + this.connectTo;\n\n        this.onInit(endpoint, (api) => {\n            api.subscribe(endpoint.processInput.bind(endpoint));\n            api.connected.link((connected) => {\n                endpoint.setupChannel(channel, api.send, this.remoteEndpoints, connected);\n            });\n        });\n\n        return this;\n    }\n}\n", "import { CallMessage } from '../types.js';\nimport { AnyFn } from '../utils/index.js';\nimport { Endpoint } from './Endpoint.js';\n\nexport type Method<T extends unknown[]> = (...args: T) => unknown;\nexport type NamespaceMethods = Record<string, Method<unknown[]>>;\nexport type Wrapper = ((...args: unknown[]) => Promise<unknown>) & { available: boolean };\nexport type ListenerCallback = (methods: string[]) => void;\nexport type Listener = {\n    event: string;\n    callback: ListenerCallback;\n    listeners: Listener | null;\n};\n\nexport class Namespace {\n    name: string;\n    owner: Endpoint<Namespace>;\n    methods: NamespaceMethods = Object.create(null);\n    remoteMethodWrappers: Record<string, Wrapper> = Object.create(null);\n    remoteMethods: string[] = [];\n    listeners: Listener | null = null;\n\n    constructor(name: string, owner: Endpoint<Namespace>) {\n        this.name = name;\n        this.owner = owner;\n        this.methods = Object.create(null);\n    }\n\n    isMethodProvided(methodName: string): boolean {\n        return methodName in this.methods;\n    }\n\n    provide<TReturn extends unknown[]>(\n        methodName: string | NamespaceMethods,\n        fn?: Method<TReturn>\n    ): void {\n        if (typeof methodName === 'string') {\n            if (typeof fn === 'function') {\n                this.methods[methodName] = fn as Method<unknown[]>;\n                this.owner.scheduleProvidedMethodsUpdate();\n            }\n        } else {\n            const methods = methodName;\n\n            for (const [methodName, fn] of Object.entries(methods)) {\n                if (typeof fn === 'function') {\n                    this.methods[methodName] = fn;\n                    this.owner.scheduleProvidedMethodsUpdate();\n                }\n            }\n        }\n    }\n\n    revoke(methodName: string | string[]): void {\n        if (Array.isArray(methodName)) {\n            methodName.forEach(this.revoke, this);\n        } else {\n            if (this.isMethodProvided(methodName)) {\n                delete this.methods[methodName];\n                this.owner.scheduleProvidedMethodsUpdate();\n            }\n        }\n    }\n\n    isRemoteMethodExists(methodName: string): boolean {\n        return this.remoteMethods.includes(methodName);\n    }\n\n    callRemote(method: string, ...args: unknown[]): Promise<unknown> {\n        let callback: AnyFn | null = null;\n\n        if (args.length && typeof args[args.length - 1] === 'function') {\n            callback = args.pop() as AnyFn;\n            console.warn(\n                '[rempl] Using a callback for Namespace#callMethod() is deprecated, use returned promise value instead'\n            );\n        }\n\n        return new Promise((resolve) => {\n            const callPacket: CallMessage = {\n                type: 'call',\n                ns: this.name,\n                method,\n                args,\n            };\n\n            this.owner.send(callPacket, (...args: unknown[]) => {\n                resolve(args[0]);\n                callback?.(...args);\n            });\n        });\n    }\n\n    getRemoteMethod(methodName: string): Wrapper {\n        let methodWrapper = this.remoteMethodWrappers[methodName];\n\n        if (typeof methodWrapper !== 'function') {\n            methodWrapper = this.remoteMethodWrappers[methodName] = Object.assign(\n                (...args: unknown[]) => {\n                    if (methodWrapper.available) {\n                        return this.callRemote(methodName, ...args);\n                    }\n\n                    return Promise.reject(\n                        new Error(\n                            `[rempl] ${this.owner.getName()} ns(\"${\n                                this.name\n                            }\") has no available remote method \"${methodName}`\n                        )\n                    );\n                },\n                {\n                    available: this.remoteMethods.indexOf(methodName) !== -1,\n                }\n            );\n        }\n\n        return methodWrapper;\n    }\n\n    onRemoteMethodsChanged(callback: ListenerCallback): AnyFn {\n        const listener: Listener = {\n            event: 'remoteMethodsChanged',\n            callback,\n            listeners: this.listeners,\n        };\n\n        this.listeners = listener;\n\n        callback([...this.remoteMethods]);\n\n        return () => {\n            let cursor = this.listeners;\n            let prev: { listeners: Listener | null } = this;\n\n            while (cursor !== null) {\n                if (cursor === listener) {\n                    prev.listeners = cursor.listeners;\n                    break;\n                }\n\n                prev = cursor;\n                cursor = cursor.listeners;\n            }\n        };\n    }\n\n    static invoke(namespace: Namespace, method: string, args: unknown[], callback: AnyFn): void {\n        // add a callback to args even if no callback, to avoid extra checking\n        // that callback is passed by remote side\n        let callbackCalled = false;\n        args = args.concat((...args: unknown[]) => {\n            callbackCalled = true;\n            callback(...args);\n            console.warn(\n                '[rempl] Using a callback in provided methods has been deprecated, just return a value or promise instead'\n            );\n        });\n\n        // invoke the provided remote method\n        Promise.resolve(namespace.methods[method].apply(null, args)).then((value) => {\n            if (!callbackCalled) {\n                callback(value);\n            }\n        });\n    }\n\n    static notifyRemoteMethodsChanged(namespace: Namespace): void {\n        let cursor = namespace.listeners;\n\n        for (const method in namespace.remoteMethodWrappers) {\n            namespace.remoteMethodWrappers[method].available =\n                namespace.remoteMethods.includes(method);\n        }\n\n        while (cursor !== null) {\n            if (cursor.event === 'remoteMethodsChanged') {\n                cursor.callback.call(null, [...namespace.remoteMethods]);\n            }\n\n            cursor = cursor.listeners;\n        }\n    }\n}\n", "import {\n    CallMessage,\n    RemoteMethodsMessage,\n    GetProvidedMethodsMessage,\n    MethodsMap,\n} from '../types.js';\nimport { AnyFn } from '../utils/index.js';\nimport { Namespace } from './Namespace.js';\nimport { ReactiveValue } from './ReactiveValue.js';\nimport { EndpointListSet } from './EndpointListSet.js';\nimport { EndpointList } from './EndpointList.js';\n\nexport type Channel = {\n    type: string;\n    send: AnyFn;\n};\n\nexport type Packet = CallMessage | RemoteMethodsMessage | GetProvidedMethodsMessage;\n\nexport class Endpoint<TNamespace extends Namespace> {\n    id: string | null;\n    namespaces: {\n        [key: string]: TNamespace;\n    };\n    get namespaceClass() {\n        return Namespace;\n    }\n    type = 'Endpoint';\n    channels: Channel[] = [];\n    connected = new ReactiveValue(false);\n    remoteEndpoints = new EndpointListSet();\n\n    providedMethodsUpdateTimer?: number | NodeJS.Timeout | null;\n\n    constructor(id?: string) {\n        this.id = id || null;\n        this.namespaces = Object.create(null);\n\n        this.remoteEndpoints.on((endpoints) => {\n            // Star is used as a hack for subscriber<->sandbox communication\n            // TODO: find a better solution\n            this.connected.set(endpoints.includes(this.id || '*'));\n        }, this);\n\n        // TODO: rework\n        // const defaultNS = this.ns('*');\n        // const methodNames: (keyof TNamespace)[] = [];\n\n        // for (\n        //     let cursor = defaultNS;\n        //     cursor && cursor != Object.prototype;\n        //     cursor = Object.getPrototypeOf(cursor)\n        // ) {\n        //     methodNames.push(...(Object.getOwnPropertyNames(cursor) as (keyof TNamespace)[]));\n        // }\n\n        // for (const method of methodNames) {\n        //     // todo rework in the next version\n        //     if (typeof defaultNS[method] === 'function') {\n        //         // @ts-ignore\n        //         this[method] = defaultNS[method].bind(defaultNS);\n        //     }\n        // }\n    }\n\n    getName() {\n        return this.type + (this.id ? '#' + this.id : '');\n    }\n\n    ns<K extends string>(name: K) {\n        let namespace = this.namespaces[name];\n\n        if (!namespace) {\n            namespace = Object.assign(new this.namespaceClass(name, this) as TNamespace);\n            this.namespaces[name] = namespace;\n        }\n\n        return namespace;\n    }\n\n    send<T = Packet>(packet: T, callback: ((...args: unknown[]) => void) | null = null): void {\n        for (const { send } of this.channels) {\n            send(packet, callback);\n        }\n    }\n\n    requestRemoteApi() {\n        this.send({ type: 'getProvidedMethods' } as const, (methods) => {\n            this.setRemoteApi(methods as MethodsMap);\n        });\n    }\n\n    setRemoteApi(api?: MethodsMap) {\n        const changed = [];\n\n        if (!api) {\n            api = {};\n        }\n\n        for (const name in api) {\n            if (Array.isArray(api[name])) {\n                const ns = this.ns(name);\n                const methods = api[name].slice().sort();\n                const different =\n                    ns.remoteMethods.length !== methods.length ||\n                    ns.remoteMethods.some(function (value, idx) {\n                        return value !== methods[idx];\n                    });\n\n                if (different) {\n                    ns.remoteMethods = methods;\n                    changed.push(ns);\n                }\n            }\n        }\n\n        for (const name in this.namespaces) {\n            if (Array.isArray(api[name]) === false) {\n                const ns = this.namespaces[name];\n\n                ns.remoteMethods = [];\n                changed.push(ns);\n            }\n        }\n\n        changed.forEach((ns) => Namespace.notifyRemoteMethodsChanged(ns));\n    }\n\n    getProvidedApi() {\n        const api: MethodsMap = Object.create(null);\n\n        for (const name in this.namespaces) {\n            api[name] = Object.keys(this.namespaces[name].methods).sort();\n        }\n\n        return api;\n    }\n\n    scheduleProvidedMethodsUpdate() {\n        if (!this.providedMethodsUpdateTimer) {\n            this.providedMethodsUpdateTimer = setTimeout(() => {\n                this.providedMethodsUpdateTimer = null;\n                this.send({\n                    type: 'remoteMethods',\n                    methods: this.getProvidedApi(),\n                });\n            }, 0);\n        }\n    }\n\n    processInput(packet: Packet, callback: AnyFn) {\n        switch (packet.type) {\n            case 'call': {\n                const thePacket = packet;\n                const ns = this.ns(thePacket.ns || '*');\n\n                if (!ns.isMethodProvided(thePacket.method)) {\n                    return console.warn(\n                        `[rempl][sync] ${this.getName()} (namespace: ${\n                            thePacket.ns || 'default'\n                        }) has no remote method:`,\n                        thePacket.method\n                    );\n                }\n\n                Namespace.invoke(ns, thePacket.method, thePacket.args, callback);\n                break;\n            }\n\n            case 'remoteMethods': {\n                const thePacket = packet;\n                this.setRemoteApi(thePacket.methods);\n                break;\n            }\n\n            case 'getProvidedMethods':\n                callback(this.getProvidedApi());\n                break;\n\n            default:\n                console.warn(\n                    '[rempl][sync] ' + this.getName() + 'Unknown packet type:',\n                    // @ts-ignore\n                    packet.type\n                );\n        }\n    }\n\n    setupChannel(type: string, send: AnyFn, remoteEndpoints: EndpointList, available: boolean) {\n        if (available) {\n            this.channels.push({\n                type,\n                send,\n            });\n            // Note that endpoints should be changed after channels is changed,\n            // since it may change this.connected that can send something to remote side\n            // when connection is established\n            this.remoteEndpoints.add(remoteEndpoints);\n        } else {\n            for (let i = 0; i < this.channels.length; i++) {\n                if (this.channels[i].type === type && this.channels[i].send === send) {\n                    this.remoteEndpoints.remove(remoteEndpoints);\n                    this.channels.splice(i, 1);\n                    break;\n                }\n            }\n        }\n    }\n}\n", "import { Namespace } from './Namespace.js';\nimport { Endpoint } from './Endpoint.js';\nimport { SubscriberPacket } from './Subscriber.js';\n\nexport type PipeFn = (...args: unknown[]) => unknown;\n\nexport class PublisherNamespace extends Namespace {\n    _lastData: unknown = null;\n    publish: (payload: unknown) => void;\n\n    constructor(name: string, owner: Publisher) {\n        super(name, owner);\n\n        this.provide('init', () => this._lastData);\n        this.publish = (payload: unknown) => {\n            this._lastData = payload;\n            owner.send<SubscriberPacket>({\n                type: 'data',\n                ns: this.name,\n                payload,\n            });\n        };\n    }\n}\n\nexport class Publisher extends Endpoint<PublisherNamespace> {\n    type = 'Publisher';\n    get namespaceClass() {\n        return PublisherNamespace;\n    }\n}\n", "type SandboxInitEvent = MessageEvent<{\n    action: 'rempl-sandbox-init-scripts';\n    scripts: Record<string, string>;\n}>;\n\nexport function initSandboxScript() {\n    addEventListener('message', function handleMessage(event: SandboxInitEvent) {\n        const { action, scripts } = event.data || {};\n\n        if (action === 'rempl-sandbox-init-scripts' && scripts) {\n            // handle message only once\n            removeEventListener('message', handleMessage);\n\n            // evaluate scripts\n            for (const [sourceURL, source] of Object.entries(scripts)) {\n                // indirect eval, see detail: https://esbuild.github.io/content-types/#direct-eval\n                Function(`${source}\\n//# sourceURL=${sourceURL}`)();\n            }\n        }\n    });\n}\n", "/* eslint-env browser */\nimport { Sandbox } from '../../types.js';\nimport { OnInitCallback, EventTransport } from '../../transport/event.js';\nimport { globalThis, trustedEmptyHTML, parent, genUID } from '../../utils/index.js';\nimport { initSandboxScript } from './sandbox-init.js';\n\ntype Global = typeof globalThis;\ntype SandboxWindow = Window | Global;\ntype Settings =\n    | {\n          type: 'script';\n          content: Record<string, string>;\n          sandboxSrc?: string;\n          window?: Window;\n          container?: HTMLElement;\n      }\n    | {\n          type: 'url';\n          content: string;\n          window?: Window;\n          container?: HTMLElement;\n      };\n\nconst initEnvSubscriberMessage = new WeakMap();\n\n// TODO: make tree-shaking friendly\nif (parent !== globalThis) {\n    addEventListener(\n        'message',\n        function (event: MessageEvent<any>) {\n            const data = event.data || {};\n\n            if (event.source && data.to === 'rempl-env-publisher:connect') {\n                initEnvSubscriberMessage.set(event.source, data);\n            }\n        },\n        true\n    );\n}\n\nexport function createSandbox(settings: Settings, callback: OnInitCallback) {\n    function initSandbox(sandboxWindow: SandboxWindow) {\n        if (settings.type === 'script') {\n            sandboxWindow.postMessage(\n                {\n                    action: 'rempl-sandbox-init-scripts',\n                    scripts: settings.content,\n                },\n                '*'\n            );\n        }\n\n        if (parent !== globalThis && sandboxWindow !== globalThis) {\n            let toSandbox = NaN;\n            let toEnv = NaN;\n\n            if (onEnvMessage) {\n                removeEventListener('message', onEnvMessage, true);\n                onEnvMessage = null;\n            }\n\n            addEventListener(\n                'message',\n                (onEnvMessage = function (event: MessageEvent<any>) {\n                    const data = event.data || {};\n\n                    switch (data.to) {\n                        case 'rempl-env-subscriber:connect':\n                        case toSandbox:\n                            toEnv = data.from;\n                            sandboxWindow.postMessage(data, '*');\n                            break;\n\n                        case 'rempl-env-publisher:connect':\n                        case toEnv:\n                            toSandbox = data.from;\n                            parent.postMessage(data);\n                            break;\n                    }\n                }),\n                true\n            );\n\n            if (settings.type !== 'script') {\n                const initMessage = initEnvSubscriberMessage.get(sandboxWindow);\n\n                if (initMessage) {\n                    toSandbox = initMessage.from;\n                    parent.postMessage(initMessage);\n                }\n            }\n        }\n\n        // sandbox <-> subscriber transport\n        // TODO: teardown transport\n        transport = EventTransport.get('rempl-sandbox', 'rempl-subscriber', sandboxWindow).onInit(\n            {},\n            (api) => callback(api)\n        );\n\n        if (connected) {\n            transport.ownEndpoints.set(['*']);\n        }\n    }\n\n    let iframe: HTMLIFrameElement | null = null;\n    let onEnvMessage: ((event: MessageEvent<any>) => void) | null = null;\n    let transport: EventTransport | null = null;\n    let connected = false;\n\n    settings = settings || {};\n\n    if (settings.window) {\n        initSandbox(settings.window);\n    } else {\n        iframe = document.createElement('iframe');\n        iframe.name = genUID(); // to avoid cache\n        iframe.onload = () => iframe?.contentWindow && initSandbox(iframe.contentWindow);\n        iframe.setAttribute('sandbox', 'allow-scripts allow-forms allow-popups allow-modals');\n\n        if (settings.type === 'url') {\n            iframe.src = settings.content;\n        } else if (settings.sandboxSrc) {\n            iframe.src = settings.sandboxSrc;\n        } else {\n            iframe.srcdoc = '<!doctype html><script>(' + String(initSandboxScript) + ')()</script>';\n            // iframe.src = URL.createObjectURL(\n            //     new Blob(\n            //         ['<!doctype html><script>(' + String(initSandboxScript) + ')()</script>'],\n            //         { type: 'text/html' }\n            //     )\n            // );\n        }\n\n        (settings.container || document.documentElement).appendChild(iframe);\n    }\n\n    const sandbox: Sandbox = {\n        setConnected(state) {\n            connected = state;\n\n            if (transport) {\n                transport.ownEndpoints.set(connected ? ['*'] : []);\n            }\n        },\n        destroy() {\n            if (onEnvMessage) {\n                removeEventListener('message', onEnvMessage, true);\n                onEnvMessage = null;\n            }\n\n            if (transport) {\n                transport.ownEndpoints.set([]);\n            }\n\n            if (iframe !== null) {\n                iframe.remove();\n                iframe.setAttribute('srcdoc', trustedEmptyHTML);\n                iframe.setAttribute('src', trustedEmptyHTML);\n                iframe = null;\n            }\n        },\n    };\n\n    return sandbox;\n}\n", "/* eslint-env browser */\ntype Options<TRef extends string> = {\n    tagName?: string;\n    ref?: TRef;\n    style?: Record<string, string>;\n    events?: Record<string, () => void>;\n    children?: Array<string | Options<TRef>>;\n} & {\n    [key: string]: any;\n};\n\nexport default function <TRef extends string>(config: Options<TRef>) {\n    function createElement(options: Options<TRef>) {\n        const element = document.createElement(options.tagName || 'div');\n\n        for (const [name, value] of Object.entries(options)) {\n            switch (name) {\n                case 'tagName':\n                    break;\n\n                case 'ref':\n                    if (typeof value === 'string') {\n                        map[value] = element;\n                    }\n                    break;\n\n                case 'style':\n                    element.setAttribute(\n                        'style',\n                        Object.entries(value)\n                            .map(([property, value]) => property + ':' + value)\n                            .join(';')\n                    );\n                    break;\n\n                case 'events':\n                    for (const event in options.events) {\n                        element.addEventListener(event, options.events[event], false);\n                    }\n                    break;\n\n                case 'children':\n                    options.children?.forEach(function (child) {\n                        element.appendChild(\n                            typeof child === 'string'\n                                ? document.createTextNode(child)\n                                : createElement(child)\n                        );\n                    });\n                    break;\n\n                default:\n                    element.setAttribute(name, value);\n            }\n        }\n\n        return element;\n    }\n\n    const map: Record<string, HTMLElement> = {};\n    map.element = createElement(config);\n    return map as { [key in TRef | 'element']: HTMLElement };\n}\n", "const styles = \":host{position:fixed;z-index:100000;inset:0;background:rgba(255,255,255,.8);backdrop-filter:blur(8px);opacity:1;font-family:Tahoma,Verdana,Arial,sans-serif;font-size:12px;transition:all cubic-bezier(.25,.59,0,1.11) .2s;border:0 solid #aaa}@supports not (backdrop-filter: blur(8px)){:host{background:rgba(255,255,255,.95)}}:host([side=\\\"left\\\"]){right:50%;border-right-width:2px}:host([side=\\\"right\\\"]){left:50%;border-left-width:2px}:host([side=\\\"top\\\"]){bottom:50%;border-bottom-width:2px}:host([side=\\\"bottom\\\"]){top:50%;border-top-width:2px}.host{display:flex;flex-direction:column;height:100%}.toolbar{display:flex;padding:0 0 0 24px;background:#f8f8f8 no-repeat 4px center / 16px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo2YTJlMWRlYi1kYzVhLTFiNDEtYTQ2OC0xYmU4ZjEyYzdkMzEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NkNGQUMzNTZCQkM4MTFFNjg1QjhENzFGM0IzRkMzNjQiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NkNGQUMzNTVCQkM4MTFFNjg1QjhENzFGM0IzRkMzNjQiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MmE1NDdhODktNWJjOC05MzQ2LWI2NTctYzAwMGQ4ZjQxOTg4IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjZhMmUxZGViLWRjNWEtMWI0MS1hNDY4LTFiZThmMTJjN2QzMSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pn3Ab4gAAAPQSURBVHjatFfNSxtBFH+JiZootWojFBUqmtioiZUWbLUt1YOI9A9QaIsWSw/1mIMInryqN8EiVKVCKx48VFA8SLUeqlSUxI+qaGyhBy1RbNQkxmT7Zt1Ns7uzcTfaBz8Sdmbe783M+xrNGqgSG+Ixwo64h8jgvu8jviGciBmES6lCjQIDEhCvES8RdxXqXUC8Q7xFhGJN1F6gqB6xiehRQQ7c3B5ubX28BvQjPiDyIH7J43T0qzGAHPkXRCNcnTRyOhPEAzrK5FnEfbUMSampYCwpAYPNBklFRZBYXg6BmRnYaW3lpzzkdD+I5YTvEc9iEel0OjAWFoLBaoVkux30SJpgsYAmPx8gOVkwl1ldhfXiYrGKIcRz2gk8FZMbs7PZXRGiJCRMQGiRDDIylIUYrtdotcCEw9GfCccwYkx8AiSW08mfgsFB0FVVAeTmXvryf1kKwbu5If58wOcQ3glf8eTssVRUUMkDTid812io2O/qguD2tmSNwW6j2ZXOcUYMcESP+kdHVe90z+GALfQDsRHJNpvcEgdvgBVhEex0eflCwtsME8Gt2VnQo2MS8XR3C+Ylog/JCOG0EgNqxCM+BQYIdllZCTcc54cYWBPGFXHcGFJDDCgTfz1yYS3x+1UZETo8PPcfk0kYCWYz6BOT5JaVabnKJpCzYBCYjQ3F5McTE6wPELneKEqgej2k3imVW2oneSCTNnKGR6m322VJieeLJXd8HFJqa6WRgI54MD9PU5MpW4yCKvzAUF0N+VtbVHLWEaXZUFCMPLQBv8ulKApu9vWBb2oKftbVUfMAewvyBni0XBcjkROnU9Hu05qbIbO9HYLr67DX1kbvaLA4yYiTGLBINWBnB5PzviIj0lta2F/v8DD8GRmRTsjJAYMpi7Z0kRgwSRsJ4/GGsZopEV1WFnsVRH7jaTDHx5I5xlKqQ08SA0jmoMbcmUIDiFxraGCzIbmKg95eqaNKMyLhXOOjoJOmNKAiEjQpKWDq6IjUBbFDGuslrWGnbDmOBCmWZBN6+GWE2d1lk1pgehp+4PWIy3F0Q/IC8UmQ4ZaWwKSUyesFZnMTQkh2iiFMwvgEr/DY7RY3JDyXpCMa49qlSFfkP0BDj44AsN/75xhnwKDSMBKRZBVYWQEfIXItQ/A0oMTUIb4bojWlpFcriG5KT7E70qSlgX9uDnxkV0jq93jivZGv0f2g3MuItM6fuS72KoV0xE/ELyVaLSATHiEGrpB8gNMZUvMyakI0INyXIHZzOprifRt+RJgRb7gHp1JZ4NaYOR2Xeh3/1+f5XwEGANZLOnq2peEfAAAAAElFTkSuQmCC);border-bottom:1px solid #ddd;white-space:nowrap}.tab{display:inline-block;padding:5px 10px;color:#666;line-height:1;cursor:pointer;border-bottom:1px solid transparent}.tab:hover{background:#eee}.tab_selected{color:#444;border-bottom:2px solid rgba(62,130,247,.6);margin-bottom:-1px}.layout-buttons{display:flex}.layout-button{display:flex;align-items:center;justify-content:center;flex:0 0 auto;width:28px;height:24px;color:#646464;cursor:pointer}.layout-button:hover{background:rgb(66,128,236);color:#fff}.layout-button:before{content:\\\"\\\";width:15px;height:13px;border:2px solid currentColor;box-sizing:border-box}:host([side=\\\"left\\\"]) .layout-button[side=left],:host([side=\\\"right\\\"]) .layout-button[side=right],:host([side=\\\"top\\\"]) .layout-button[side=top],:host([side=\\\"bottom\\\"]) .layout-button[side=bottom],:host([side=\\\"fit the page\\\"]) .layout-button[side=\\\"fit the page\\\"]{color:#4280ec;background:none;cursor:default}.layout-button[side=external]:before{height:10px;width:13px;border-width:0 0 2px 2px;margin-bottom:-3px}.layout-button[side=external]:after{content:\\\"\\\";height:10px;width:13px;border:2px solid currentColor;box-sizing:border-box;margin-top:-3px;margin-left:-10px}.layout-button[side=top]:before{border-top-width:5px}.layout-button[side=right]:before{border-right-width:5px}.layout-button[side=bottom]:before{border-bottom-width:5px}.layout-button[side=left]:before{border-left-width:5px}.close-button{position:relative;width:28px;text-align:center;font:20px Arial,sans-serif;color:#5a5a5a;cursor:pointer}.close-button:hover{color:#000}.close-button:after{content:\\\"\\\\d7\\\";line-height:24px}.sandbox{flex:1 1 auto;position:relative}iframe{position:absolute;top:0;left:0;width:100%;height:100%;border:0;background:transparent}\\n\"; // content from ./style.css will be here';\n\nexport { styles as default };\n//# sourceMappingURL=style.js.map\n", "/* eslint-env browser */\n\nimport { trustedEmptyHTML } from '../../utils/index.js';\nimport createElement from './createElement.js';\nimport styles from './style.js';\n\ntype Side = 'left' | 'top' | 'bottom' | 'right' | 'fit the page';\ntype View = {\n    wrapper: HTMLElement;\n    element: HTMLElement;\n    tabs: HTMLElement;\n    buttons: HTMLElement;\n    sandbox: HTMLElement;\n};\n\nlet publishers: string[] = [];\nlet selectedPublisher: string | null = null;\nlet selectPublisher: (id?: string) => void = () => {};\nlet view: View | null = null;\nlet onClose: () => void;\n\n// settings persistance\nconst settings: Record<string, any> = {};\n\nfunction setSetting(name: string, value: any) {\n    settings[name] = value;\n    try {\n        localStorage.rempl = JSON.stringify(settings);\n    } catch (e) {}\n}\n\nfunction updateTabSelectedState(tabEl: HTMLElement) {\n    tabEl.classList.toggle('tab_selected', tabEl.getAttribute('publisher') === selectedPublisher);\n}\n\nfunction updatePublisherList() {\n    const { tabs } = getView();\n\n    tabs.innerHTML = trustedEmptyHTML;\n\n    for (const publisher of publishers) {\n        const { element } = createElement({\n            publisher,\n            class: 'tab',\n            children: [publisher],\n            events: {\n                click() {\n                    selectPublisher(publisher);\n                },\n            },\n        });\n\n        updateTabSelectedState(element);\n        tabs.appendChild(element);\n    }\n}\n\nfunction getView(): View {\n    if (view === null) {\n        const wrapperEl = document.createElement('div');\n        const shadow = wrapperEl.attachShadow({ mode: 'open' });\n        const styleEl = document.createElement('style');\n        const content = createElement({\n            class: 'host',\n            children: [\n                {\n                    class: 'toolbar',\n                    children: [\n                        {\n                            ref: 'tabs',\n                            style: {\n                                display: 'flex',\n                                flex: '1',\n                            },\n                        },\n                        {\n                            ref: 'buttons',\n                            class: 'layout-buttons',\n                            children: [\n                                ...(\n                                    ['left', 'top', 'bottom', 'right', 'fit the page'] as Side[]\n                                ).map((side: Side) => ({\n                                    side,\n                                    title: `Dock to ${side}`,\n                                    class: 'layout-button',\n                                    events: {\n                                        click() {\n                                            wrapperEl.setAttribute('side', side);\n                                            setSetting('host-dock', side);\n                                        },\n                                    },\n                                })),\n                                {\n                                    class: 'close-button',\n                                    events: {\n                                        click() {\n                                            onClose?.();\n                                        },\n                                    },\n                                },\n                            ],\n                        },\n                    ],\n                },\n                {\n                    ref: 'sandbox',\n                    class: 'sandbox',\n                },\n            ],\n        });\n\n        try {\n            Object.assign(settings, JSON.parse(localStorage.rempl || '{}'));\n        } catch (e) {}\n\n        wrapperEl.setAttribute('side', settings['host-dock'] || 'bottom');\n        styleEl.append(document.createTextNode(styles));\n        shadow.append(styleEl);\n        shadow.append(content.element);\n\n        view = {\n            wrapper: wrapperEl,\n            ...content,\n        };\n        updatePublisherList();\n    }\n\n    return view;\n}\n\nfunction showView(closeCallback: () => void): void {\n    const { wrapper } = getView();\n\n    onClose = closeCallback;\n\n    wrapper.style.display = '';\n    if (!document.contains(wrapper)) {\n        (document.body || document.documentElement).append(wrapper);\n    }\n}\n\nfunction softHideView(): void {\n    getView().wrapper.style.display = 'none';\n}\n\nfunction hideView(): void {\n    getView().wrapper.remove();\n}\n\nexport default {\n    show: showView,\n    hide: hideView,\n    softHide: softHideView,\n    getSandboxContainer() {\n        return getView().sandbox;\n    },\n    setPublisherList(publisherList: string[], selectPublisherFn: (id?: string) => void) {\n        publishers = publisherList;\n        selectPublisher = selectPublisherFn;\n        updatePublisherList();\n    },\n    selectPublisher(id: string) {\n        if (selectedPublisher !== id) {\n            selectedPublisher = id;\n\n            if (view) {\n                Array.from(getView().tabs.children).forEach((el) =>\n                    updateTabSelectedState(el as HTMLElement)\n                );\n            }\n        }\n    },\n};\n", "/* eslint-env browser */\nimport { Host } from '../../types.js';\nimport { trustedEmptyHTML } from '../../utils/index.js';\nimport { EventTransport } from '../../transport/event.js';\nimport { createSandbox } from '../../sandbox/browser/index.js';\nimport view from './view.js';\n\nlet publishers: string[] = [];\nlet selectedPublisherId: string | null = null;\nlet autoSelectPublisher = false;\nlet teardownTimer: ReturnType<typeof setTimeout>;\nlet transport: EventTransport | null = null;\nlet sandbox: ReturnType<typeof createSandbox> | null = null;\nlet host: Host | null = null;\n\nfunction cleanupSandbox() {\n    if (sandbox !== null) {\n        sandbox.destroy();\n        sandbox = null;\n    }\n}\n\nfunction selectPublisher(publisherId: string | null = null) {\n    if (!publisherId) {\n        publisherId = null;\n    }\n\n    if (publisherId !== selectedPublisherId) {\n        autoSelectPublisher = false;\n        selectedPublisherId = publisherId;\n\n        if (selectedPublisherId) {\n            view.selectPublisher(selectedPublisherId);\n            view.show((host as Host).deactivate);\n            (transport as EventTransport).onInit(\n                { id: selectedPublisherId },\n                function initSandbox(papi) {\n                    papi.getRemoteUI((error, type, content) => {\n                        const sandboxContainerEl = view.getSandboxContainer();\n\n                        cleanupSandbox();\n\n                        if (error) {\n                            const errorEl = document.createElement('div');\n                            errorEl.append('Error on loading UI: ', error);\n                            errorEl.setAttribute(\n                                'style',\n                                'margin:10px;padding:5px 10px;border-radius:3px;border:1px solid #eba8a8;color:#f34040;background:#ffe0e0;'\n                            );\n\n                            sandboxContainerEl.innerHTML = trustedEmptyHTML;\n                            sandboxContainerEl.append(errorEl);\n                        } else {\n                            sandbox = createSandbox(\n                                {\n                                    container: sandboxContainerEl,\n                                    type,\n                                    content,\n                                },\n                                (api) => {\n                                    papi.subscribe(api.send);\n                                    api.subscribe(papi.send);\n                                }\n                            );\n                            sandbox.setConnected(true);\n                        }\n                    });\n                }\n            );\n        } else {\n            view.hide();\n            cleanupSandbox();\n        }\n    }\n}\n\nexport function getHost() {\n    if (host !== null) {\n        return host;\n    }\n\n    transport = EventTransport.get('rempl-inpage-host', 'rempl-inpage-publisher');\n    transport.remoteEndpoints.on((endpoints) => {\n        publishers = endpoints;\n        view.setPublisherList(publishers, selectPublisher);\n\n        if (autoSelectPublisher && !selectedPublisherId && publishers.length) {\n            selectPublisher(publishers[0]);\n        }\n    });\n\n    return (host = {\n        activate(publisher) {\n            const publisherId =\n                typeof publisher === 'string'\n                    ? publisher\n                    : publisher?.id || selectedPublisherId || publishers[0] || null;\n\n            clearTimeout(teardownTimer);\n            selectPublisher(publisherId);\n            view.show((host as Host).deactivate);\n\n            if (!selectedPublisherId) {\n                autoSelectPublisher = true;\n            }\n        },\n        deactivate(publisher) {\n            const publisherId = typeof publisher === 'string' ? publisher : publisher?.id || null;\n\n            autoSelectPublisher = false;\n\n            if (!publisherId || publisherId === selectedPublisherId) {\n                view.softHide();\n                // tear down subscriber in 15 sec\n                clearTimeout(teardownTimer);\n                teardownTimer = setTimeout(() => selectPublisher(), 15000);\n            }\n        },\n    });\n}\n", "import { Publisher } from '../classes/Publisher.js';\nimport {\n    GetRemoteUIHandler,\n    PublisherOptions,\n    GetRemoteUIInternalResult,\n    GetRemoteUISettings,\n} from '../types.js';\n\nexport class TransportPublisher extends Publisher {\n    getRemoteUI: (settings: GetRemoteUISettings) => Promise<GetRemoteUIInternalResult>;\n    options: PublisherOptions;\n\n    constructor(id: string, getRemoteUI: GetRemoteUIHandler, options?: PublisherOptions) {\n        super(id);\n\n        this.options = options || {};\n        this.getRemoteUI = (settings) => {\n            try {\n                return Promise.resolve(getRemoteUI(settings)).then((result) => {\n                    if (result.type === 'script') {\n                        // TODO: value should be a string\n                        return {\n                            type: 'script',\n                            value: {\n                                'publisher-ui.js': result.value,\n                            },\n                        };\n                    }\n\n                    return result;\n                });\n            } catch (e: any) {\n                return Promise.reject(e);\n            }\n        };\n    }\n}\n", "import { WsTransport } from '../transport/ws.js';\nimport { TransportPublisher } from './TransportPublisher.js';\nimport { GetRemoteUIHandler, PublisherOptions, PublisherWsSettings } from '../types.js';\n\nconst publishers = new Map<string, TransportPublisher>();\nlet ws: WsTransport | null = null;\n\nexport function getPublisher(\n    id: string,\n    getRemoteUI: GetRemoteUIHandler,\n    options?: PublisherOptions\n) {\n    let publisher = publishers.get(id);\n\n    if (publisher) {\n        console.warn(`[rempl] Publisher with ID \"${id}\" has been already created`);\n        return publisher;\n    }\n\n    publisher = new TransportPublisher(id, getRemoteUI, options);\n    publishers.set(id, publisher);\n\n    if (ws) {\n        ws.sync(publisher);\n    }\n\n    return publisher;\n}\n\nexport function resolveWsUri(\n    settings: { explicit: string | undefined; implicit: string },\n    uri?: string\n) {\n    switch (uri) {\n        case 'implicit':\n        case undefined:\n            return settings.explicit || settings.implicit;\n\n        case 'explicit':\n            return settings.explicit;\n    }\n\n    return uri;\n}\n\nexport function connect(\n    auto: boolean,\n    createWsTransport: (uri: string) => WsTransport,\n    fetchWsSettings: () => PublisherWsSettings,\n    uri?: string\n) {\n    if (ws === null) {\n        uri = auto ? fetchWsSettings().explicit : resolveWsUri(fetchWsSettings(), uri);\n\n        if (typeof uri === 'string') {\n            ws = createWsTransport(uri);\n\n            for (const publisher of publishers.values()) {\n                ws.sync(publisher);\n            }\n        } else if (!auto) {\n            console.warn(\n                \"[rempl] Connection to WS server doesn't established since bad value for URI\",\n                uri\n            );\n        }\n    } else {\n        console.warn('[rempl] Connection to WS server already set');\n    }\n}\n", "// @ts-ignore\nimport { ReactiveValue } from '../classes/ReactiveValue.js';\nimport { EndpointList } from '../classes/EndpointList.js';\nimport * as utils from '../utils/index.js';\nimport { AnyFn } from '../utils/index.js';\nimport { GetRemoteUIInternalHandler, GetRemoteUISettings } from '../types.js';\nimport { TransportPublisher } from '../publisher/TransportPublisher.js';\n\nconst endpoints: Record<string, WsTransport> = Object.create(null);\nconst INFO_UPDATE_TIME = 100;\nconst DEBUG = false;\nconst DEBUG_PREFIX = '[rempl][ws-transport] ';\n\nexport type SelfInfo = Pick<WsTransport, 'id' | 'sessionId' | 'type' | 'publishers'>;\n\nexport type API = {\n    connected: ReactiveValue<boolean>;\n    send(...args: unknown[]): void;\n    subscribe(fn: AnyFn): void;\n};\n\ninterface Socket {\n    emit(...args: unknown[]): void;\n    on(event: string, callback: AnyFn): this;\n}\n\nfunction valuesChanged(a: any, b: any) {\n    for (const key of Object.keys(a)) {\n        const value1 = a[key];\n        const value2 = b[key];\n\n        if (Array.isArray(value1)) {\n            if (valuesChanged(value1, value2)) {\n                return true;\n            }\n        } else {\n            if (String(value1) !== String(value2)) {\n                return true;\n            }\n        }\n    }\n\n    return false;\n}\n\nfunction normalizeUri(uri: string) {\n    uri = String(uri);\n\n    if (/^\\d+$/.test(uri)) {\n        return 'ws://localhost:' + uri;\n    }\n\n    return uri\n        .replace(/^http:\\/\\//i, 'ws://')\n        .replace(/^https:\\/\\//i, 'wss://')\n        .replace(/^([a-z]+:\\/\\/)|^/i, function (m, protocol) {\n            protocol = protocol ? protocol.toLowerCase() : '';\n            return protocol === 'ws://' || protocol === 'wss://' ? protocol : 'ws://';\n        });\n}\n\nfunction subscribe(this: WsTransport, endpoint: string | null, fn: AnyFn) {\n    return utils.subscribe(this.dataCallbacks, {\n        endpoint,\n        fn,\n    });\n}\n\nfunction send(this: WsTransport, endpoint: string | null, callback?: AnyFn) {\n    this.send('rempl:from publisher', endpoint, callback);\n}\n\nfunction onConnect(this: WsTransport) {\n    clearInterval(this.sendInfoTimer as number);\n\n    this.connected.set(true);\n    this.info = this.getInfo();\n\n    this.send('rempl:endpoint connect', this.info, (data) => {\n        if ('id' in data) {\n            this.setClientId(data.id);\n        }\n\n        this.sendInfoTimer = setInterval(this.sendInfo.bind(this), INFO_UPDATE_TIME);\n    });\n\n    if (DEBUG) {\n        console.log(DEBUG_PREFIX + 'connected');\n    }\n}\n\nfunction onGetUI(\n    this: WsTransport,\n    id: string | null,\n    settings: GetRemoteUISettings,\n    callback: (\n        error: string | null,\n        type?: 'url' | 'script',\n        value?: string | Record<string, string>\n    ) => void\n) {\n    const publisherMeta = this.publishersMap.get(id as string);\n\n    if (!publisherMeta) {\n        if (DEBUG) {\n            console.error(DEBUG_PREFIX + 'Publisher `' + id + \"` isn't registered\");\n        }\n\n        callback('Publisher `' + id + \"` isn't registered\");\n        return;\n    }\n\n    return publisherMeta\n        .getRemoteUI(settings || {})\n        .catch((error) => ({ error: String(error?.message) }))\n        .then((res) => {\n            if ('error' in res) {\n                callback(res.error);\n            } else {\n                callback(null, res.type, res.value);\n            }\n        });\n}\n\nfunction onData(this: WsTransport, id: string | null, ...args: unknown[]) {\n    if (!this.publishersMap.has(id as string)) {\n        if (DEBUG) {\n            console.error(DEBUG_PREFIX + 'Publisher `' + id + \"` isn't registered\");\n        }\n\n        return;\n    }\n\n    this.dataCallbacks.forEach(function (callback) {\n        if (callback.endpoint === id) {\n            callback.fn.apply(null, args);\n        }\n    });\n}\n\nfunction onDisconnect(this: WsTransport) {\n    if (DEBUG) {\n        console.log(DEBUG_PREFIX + 'disconnected');\n    }\n\n    clearInterval(this.sendInfoTimer as number);\n    this.connected.set(false);\n}\n\nexport class WsTransport {\n    static get(endpoint: string, socketIO: any): WsTransport {\n        if (endpoint in endpoints) {\n            return endpoints[endpoint];\n        }\n\n        return (endpoints[endpoint] = new this(endpoint, socketIO));\n    }\n\n    publishers: string[] = [];\n    publishersMap = new Map<string, { getRemoteUI: GetRemoteUIInternalHandler }>();\n    dataCallbacks: Array<{ endpoint: string | null; fn: AnyFn }> = [];\n\n    connected = new ReactiveValue(false);\n    ownEndpoints = new EndpointList();\n    remoteEndpoints = new EndpointList();\n\n    socket: Socket;\n\n    sessionId = utils.genUID();\n    id: string | null = null;\n    sendInfoTimer: number | NodeJS.Timeout | null = null;\n    info = this.getInfo();\n\n    constructor(uri: string, socketIO: any) {\n        if (DEBUG) {\n            console.log(DEBUG_PREFIX + 'connecting to ' + normalizeUri(uri));\n        }\n\n        this.socket = socketIO\n            .connect(normalizeUri(uri), { transports: ['websocket'] })\n            .on('connect', onConnect.bind(this))\n            .on('disconnect', onDisconnect.bind(this))\n            .on('rempl:get ui', onGetUI.bind(this))\n            .on('rempl:to publisher', onData.bind(this));\n    }\n\n    get type(): string {\n        return 'unknown';\n    }\n\n    setClientId(id: string): void {\n        this.id = id;\n    }\n\n    /**\n     * Send data through WS\n     */\n    send(name: string, arg: unknown, callback?: AnyFn): void {\n        this.socket.emit(name, arg, callback);\n    }\n\n    /**\n     * Get self info\n     */\n    getInfo(): SelfInfo {\n        return {\n            id: this.id,\n            sessionId: this.sessionId,\n            type: this.type,\n            publishers: [...this.publishers],\n        };\n    }\n\n    /**\n     * Send self info to server\n     */\n    sendInfo() {\n        const newInfo = this.getInfo();\n\n        if (valuesChanged(this.info, newInfo)) {\n            this.info = newInfo;\n            this.send('rempl:endpoint info', this.info);\n        }\n    }\n\n    createApi(publisher: TransportPublisher): API | undefined {\n        if (this.publishersMap.has(publisher.id as string)) {\n            if (DEBUG) {\n                console.error(\n                    DEBUG_PREFIX + 'Publisher `' + publisher.id + '` is already registered'\n                );\n            }\n\n            return;\n        }\n\n        if (publisher.id) {\n            this.publishers.push(publisher.id);\n            // todo \u0442\u043E\u0447\u043D\u043E \u0432\u0441\u0435\u0433\u0434\u0430 \u0435\u0441\u0442\u044C getRemoteUI\n            this.publishersMap.set(publisher.id, {\n                getRemoteUI: publisher.getRemoteUI,\n            });\n        }\n\n        this.sendInfo();\n\n        return {\n            connected: this.connected,\n            send: send.bind(this, publisher.id),\n            subscribe: subscribe.bind(this, publisher.id),\n        };\n    }\n\n    sync(publisher: TransportPublisher) {\n        const api = this.createApi(publisher);\n\n        if (api) {\n            api.subscribe(publisher.processInput.bind(publisher));\n            api.connected.link((connected) => {\n                publisher.setupChannel('ws', api.send, this.remoteEndpoints, connected);\n            });\n        }\n    }\n}\n", "const __CSS__ = \":host{position:fixed;overflow:auto;inset:0;z-index:100000000;background:rgba(255,255,255,.9);text-align:center;line-height:1.5;font-family:Tahoma,Verdana,Arial,sans-serif}h1{font-size:100px;font-size:33vh;font-size:clamp(20px,33vh,100px);font-weight:400;margin:0}button{font-size:18px;line-height:1;padding:12px 24px;background:#3bafda;color:#fff;border:none;border-radius:3px;cursor:pointer}\\n\"; // content from ./style.css will be here';\n\nexport { __CSS__ as default };\n//# sourceMappingURL=style.js.map\n", "/* eslint-env browser */\n\nimport __CSS__ from './style.js';\n\ntype StopIdentifyMessage = { op: 'stop-identify' };\ntype AddPublisherMessage = { op: 'add-publisher'; id: string; name: string };\ntype Message = StopIdentifyMessage | AddPublisherMessage;\n\nconst identifyWidgetId = 'rempl-identify-widget';\nlet cancelOverlay: (() => void) | null = null;\n\nfunction createOverlay(origin: string, num: string) {\n    const overlayEl = document.createElement('div');\n    const shadow = overlayEl.attachShadow({ mode: 'closed' });\n    const styleEl = document.createElement('style');\n    const buttonsEl = document.createElement('div');\n    const headerEl = document.createElement('h1');\n\n    overlayEl.id = identifyWidgetId;\n    overlayEl.dataset.origin = origin;\n    headerEl.textContent = num;\n    styleEl.textContent = __CSS__;\n\n    shadow.append(styleEl, headerEl, buttonsEl);\n\n    return {\n        overlayEl,\n        createButton(name: string, pickPublisher: () => void) {\n            const wrapperEl = buttonsEl.appendChild(document.createElement('div'));\n            const buttonEl = wrapperEl.appendChild(document.createElement('button'));\n\n            wrapperEl.setAttribute('style', 'margin-bottom:5px');\n\n            buttonEl.textContent = name;\n            buttonEl.addEventListener('click', pickPublisher);\n        },\n    };\n}\n\nexport function postIdentifyMessage(params: Message) {\n    postMessage({ to: identifyWidgetId, ...params });\n}\n\nexport function startIdentify(\n    origin: string,\n    num: number | string,\n    callback: (publisherId: string) => void\n) {\n    if (typeof document === 'undefined') {\n        return;\n    }\n\n    const existingWidget = document.querySelector('#' + identifyWidgetId);\n\n    if (!existingWidget || (existingWidget as HTMLElement).dataset.origin !== origin) {\n        if (existingWidget) {\n            postMessage({ op: 'stop-identify' });\n        }\n\n        const { overlayEl, createButton } = createOverlay(origin, String(num));\n\n        const documentStyleOverflow = document.body.style.overflow;\n        document.body.style.overflow = 'hidden';\n        document.body.appendChild(overlayEl);\n\n        const onMessageCallback = (\n            event: MessageEvent<Message & { to: typeof identifyWidgetId }>\n        ) => {\n            const { data } = event;\n\n            if (data?.to === identifyWidgetId) {\n                switch (data.op) {\n                    case 'add-publisher':\n                        createButton(data.name || data.id, () => callback(data.id));\n                        break;\n\n                    case 'stop-identify':\n                        console.log('stop-indentify');\n                        cancelOverlay?.();\n                        break;\n                }\n            }\n        };\n\n        addEventListener('message', onMessageCallback);\n\n        cancelOverlay = () => {\n            removeEventListener('message', onMessageCallback);\n            document.body.style.overflow = documentStyleOverflow;\n            overlayEl.remove();\n            cancelOverlay = null;\n        };\n    }\n}\n\nexport function stopIdentify() {\n    if (typeof cancelOverlay === 'function') {\n        cancelOverlay();\n    }\n}\n", "/* eslint-env browser */\n\nimport socketIO from 'socket.io-client/dist/socket.io.slim.js';\nimport { WsTransport } from '../../transport/ws.js';\nimport { postIdentifyMessage, startIdentify, stopIdentify } from './identify/index.js';\nimport { globalThis, top } from '../../utils/index.js';\n\nconst STORAGE_KEY = 'rempl:id';\ndeclare let REMPL_SERVER: string | boolean;\n\nexport function fetchWsSettings() {\n    function fetchEnvVariable() {\n        if (typeof REMPL_SERVER !== 'undefined' && REMPL_SERVER !== globalThis.REMPL_SERVER) {\n            return REMPL_SERVER;\n        }\n    }\n\n    function fetchMeta() {\n        const meta =\n            typeof document !== 'undefined'\n                ? document.querySelector('meta[name=\"rempl:server\"]')\n                : undefined;\n\n        return (meta && meta.getAttribute('content')) || undefined;\n    }\n\n    const implicitUri = location.protocol + '//' + (location.hostname || 'localhost') + ':8177';\n    let explicitUri = undefined;\n    let setup = fetchEnvVariable();\n\n    if (setup === undefined) {\n        setup = fetchMeta();\n    }\n\n    switch (setup) {\n        case 'none':\n        case undefined:\n        case false:\n            // no explicit setting\n            break;\n\n        case 'implicit':\n        case 'auto':\n        case true:\n            explicitUri = implicitUri;\n            break;\n\n        default:\n            if (typeof setup === 'string') {\n                explicitUri = setup;\n            }\n    }\n\n    return {\n        explicit: explicitUri,\n        implicit: implicitUri,\n    };\n}\n\nexport class BrowserWsTransport extends WsTransport {\n    constructor(uri: string) {\n        super(uri, socketIO);\n\n        const self = this;\n\n        try {\n            this.id = sessionStorage[STORAGE_KEY];\n        } catch (e) {}\n\n        this.socket\n            .on(\n                'rempl:identify',\n                function (num: string | number, callback: (publisherId: string) => void) {\n                    startIdentify((this as any).io.uri, num, callback);\n\n                    for (const publisherId of self.publishers) {\n                        postIdentifyMessage({\n                            op: 'add-publisher',\n                            id: publisherId,\n                            name: publisherId,\n                        });\n                    }\n                }\n            )\n            .on('rempl:stop identify', stopIdentify)\n            .on('disconnect', stopIdentify);\n    }\n\n    get type() {\n        return 'browser';\n    }\n\n    setClientId(id: string) {\n        super.setClientId(id);\n        try {\n            sessionStorage[STORAGE_KEY] = this.id;\n        } catch (e) {}\n    }\n\n    getInfo() {\n        return {\n            ...super.getInfo(),\n            location: String(location),\n            title: top?.document?.title || top?.location?.href || 'Unknown',\n        };\n    }\n}\n\nexport function createBrowserWsTransport(uri: string) {\n    return new BrowserWsTransport(uri);\n}\n", "import { GetRemoteUIHandler, PublisherOptions } from '../../types.js';\nimport { EventTransport } from '../../transport/event.js';\nimport { getPublisher, connect } from '../factory.js';\nimport { createBrowserWsTransport, fetchWsSettings } from './transport-ws.js';\n\nexport function createPublisher(\n    id: string,\n    getRemoteUI: GetRemoteUIHandler,\n    options?: PublisherOptions\n) {\n    connect(true, createBrowserWsTransport, fetchWsSettings);\n\n    const publisher = getPublisher(id, getRemoteUI, options);\n\n    // browser extension\n    EventTransport.get('rempl-browser-extension-publisher', 'rempl-browser-extension-host').sync(\n        publisher\n    );\n\n    // in page\n    EventTransport.get('rempl-inpage-publisher', 'rempl-inpage-host').sync(publisher);\n\n    // self subscriber\n    EventTransport.get('rempl-self-publisher', 'rempl-self-subscriber').sync(publisher);\n\n    return Object.assign(publisher.ns('*'), {\n        ns: publisher.ns.bind(publisher),\n    });\n}\n\nexport function connectPublisherWs(uri?: string) {\n    connect(false, createBrowserWsTransport, fetchWsSettings, uri);\n}\n", "import { getHost } from \"rempl\";\n\nlet config: { inPage?: boolean } = {};\n\nconst setConfig = (c: typeof config) => {\n  console.log('setConfig', c)\n  config = {...config, ...c};\n\n  if (config.inPage) {\n    getHost().activate();\n  } else {\n    getHost().deactivate();\n  }\n};\n\nexport {\n  config,\n  setConfig\n};\n", "import { Message } from \"common-types\";\nimport { createPublisher } from \"rempl\";\nimport { ToolId } from \"../common/constants\";\n\nlet eventIdSeed = 0;\n\n// const events: Message[] = [];\n\ndeclare let __DEV__: boolean;\ndeclare let __UI_SRC__: string;\n\nexport const publisher = createPublisher(ToolId, () => ({\n  type: \"script\",\n  value: __UI_SRC__,\n}));\n\nexport type Publisher = typeof publisher;\n\nfunction isReactSyntheticEvent(event: any) {\n  if (typeof event !== \"object\" || event === null) {\n    return false;\n  }\n  return \"_dispatchListeners\" in event;\n}\n\nconst stringify = (obj: any) => {\n  return JSON.stringify(obj, (k, v) => {\n    if (v && isReactSyntheticEvent(v)) return \"SyntheticEvent\";\n    if (v && typeof v === \"object\") {\n      // if (v instanceof Event || (typeof v?.originalEvent === 'object' && v?.originalEvent instanceof Event)) return 'Event';\n      if (v instanceof Node) return \"Node\";\n      if (v instanceof Window) return \"Window\";\n    }\n    return v;\n  });\n};\n\nlet isReady = false;\nconst stack: any[] = [];\n\nconst eventLogChannel = publisher.ns(\"logs\");\n\npublisher.provide(\"isReady\", () => {\n  isReady = true;\n  if (stack.length) {\n    while (stack.length) {\n      eventLogChannel.publish(stack.shift());\n    }\n  }\n});\n\nexport const publishLog = (message: Omit<Message, \"id\">) => {\n  const id = eventIdSeed++;\n\n  const { name, op, kind, payload } = message;\n\n  const data = {\n    id,\n    name,\n    kind,\n    op,\n    payload: stringify(payload),\n  };\n\n  if (isReady) {\n    eventLogChannel.publish(data);\n  } else {\n    stack.push(data);\n  }\n};\n"],
  "mappings": "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",
  "names": ["debounce", "result", "globalThis", "transport", "utils.genUID", "globalThis", "endpoints", "_a", "utils.subscribe", "methodName", "fn", "args", "endpoints", "send", "parent", "globalThis", "settings", "transport", "sandbox", "config", "createElement", "_a", "value", "publisher", "publishers", "selectPublisher", "endpoints", "publisher", "settings", "publishers", "publisher", "settings", "fetchWsSettings", "subscribe", "utils.subscribe", "settings", "socketIO", "utils.genUID", "publisher", "globalThis", "socketIO", "self", "top", "publisher", "publisher", "debounce"]
}
